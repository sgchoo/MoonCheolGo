<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8"/>
        <meta title="viewport" content="width=device-width, initial-scale=1.0"/>

        <!-- Tailwind CSS  -->
        <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>

        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
            crossorigin="anonymous"></script>

        <style>
            #apply-box
            {
                display: none;
            }
        </style>

        <script>
            $(document).ready(function()
            {
                $("#moonchuls").html("");
                showMoonchuls();
            })

            function OpenClose()
            {
                let status = $('#apply-box').css('display')
                if(status == 'block')
                {
                    $('#apply-box').hide()
                }
                else
                {
                    $('#apply-box').show()
                }
            }
            function applyMoonchul()
            {
                let subject = $("#subject").val();
                let argument = $("#argument").val();
                let position_1 =$("#position-1").val();
                let position_2 =$("#position-2").val();

                $.ajax
                ({
                    type: "POST",
                    url: "/main",
                    data: {subject_give: subject, argument_give: argument, position_1_give: position_1, position_2_give: position_2},
                    success:function(response)
                    {
                        if(response["result"] == 'success')
                        {
                            alert("문철이 등록되었습니다.")
                            window.location.reload();
                        }
                        else
                        {
                            alert("등록에 실패하였습니다.")
                        }
                    }
                })
            }

            function makeMoonchul(subject)
            {
                let tempHtml = `<p><button>${subject}</button></p>`;
                $("#moonchuls").append(tempHtml);
            }

            function showMoonchuls()
            {
                $.ajax
                ({
                    type: "GET",
                    url: "/main",
                    data: {},
                    success: function(response)
                    {
                        let moonchuls = response["moonchuls"];
                        //console.log(moonchuls);
                        for(let i = 0; i < moonchuls.length; i++)
                        {
                            makeMoonchul(moonchuls[i]["subject"]);
                        }
                        //console.log("거쳤다")
                    }

                })
            }
            
            function ProceedingMode()
            {
                showMoonchuls(true);
            }
            function ResultMode()
            {
                showMoonchuls(false);
            }
        </script>

    </head>
    <body>
        <div class="md:container mx-auto">
            <div class="flex items-center justify-center">
                <h1 class="mt-8 text-4xl font-bold">문철</h1>
            </div>
            <div class="flex items-center justify-center">
                <button class="bg-yellow-100 hover:bg-yellow-200 font-medium rounded-lg text-sm px-5 py-2.5 mt-3" onclick="OpenClose()" id="btn-apply-box">문철 신청하기</button>
            </div>
        </div>
        
        <div class="md:container mx-auto applyBox" id="apply-box" style="width:40%">
            <p>
                <label for="subject" class="mb-2 text-l font-bold text-gray-900">키워드</label>
                <input type="text" id="subject1" class="mb-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-yellow-400 focus:border-yellow-400 w-full" placeholder="논점 키워드를 입력해주세요." required>
                <input type="text" id="subject2" class="mb-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-yellow-400 focus:border-yellow-400 w-full" placeholder="논점 키워드를 입력해주세요." required>
            </p>
            <p>
                <label for="argument" class="mb-2 text-l font-bold text-gray-900">내용</label>
                <textarea id="argument" name="argument" rows="4" class="p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-yellow-400 focus:border-yellow-400" placeholder="자세한 설명을 적어주세요."></textarea>
            </p>
            <p>
                <label for="position-1" class="mb-2 text-l font-bold text-gray-900">입장1</label>
                <textarea id="position-1" name="position-1" rows="4" class="p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-yellow-400 focus:border-yellow-400" placeholder="입장1"></textarea>
            </p>
            <p>
                <label for="position-2" class="mb-2 text-l font-bold text-gray-900">입장2</label>
                <textarea id="position-2" name="position-2" rows="4" class="p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-yellow-400 focus:border-yellow-400" placeholder="입장2"></textarea>
            </p>
            <div class="flex items-center justify-center">
                <button type="submit" class="bg-yellow-100 hover:bg-yellow-200 font-medium rounded-lg text-sm px-5 py-2.5 text-center mt-3" onclick="applyMoonchul()">제출하기</button>
            </div>
        </div>

        <div class="moonchulButton md:container mx-auto bg-red-200" style="width:40%">
            <a href = "#" onclick = "ProceedingMode()" id = "proceeding">진행중</a>
            <a href = "#" onclick = "ResultMode()" id = "result">결과</a>
        </div>
    </body>
</html>